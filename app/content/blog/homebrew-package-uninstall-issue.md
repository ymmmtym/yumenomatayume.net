---
title: "Homebrew でパッケージが消えない時 🍺"
description: "Homebrewを使っていると、時々パッケージが正常にアンインストールできないことがあります。"
pubDate: "2025-11-15"
tags: ["mac", "homebrew"]
---

Homebrewを使っていると、時々パッケージが正常にアンインストールできないことがあります 😅 `brew uninstall`コマンドを実行してもパッケージが削除されず、`brew outdated`を実行すると古いバージョンが依然として表示され続ける、という問題に遭遇しました。

この記事では、その原因と解決策について解説します 💡

## 問題の状況

`onyx`というCaskパッケージをアンインストールしようとしたところ、以下のような状況になりました 🤔

```bash
> brew uninstall onyx
==> Uninstalling Cask onyx
==> Purging files for version 4.9.2 of Cask onyx
```

一見アンインストールが成功したように見えますが、`brew outdated`を実行すると、古いバージョンが残っていると表示されてしまいます 😵

```bash
> brew outdated
onyx (4.8.5) != 4.9.2
```

再度`brew uninstall`を実行しても、同じ結果が繰り返されるだけでした 🔄

## 原因

この問題は、おそらくパッケージのインストール中に何らかの理由で処理が中断され、Homebrewが管理しているバージョン情報と、実際にインストールされているファイルとの間に不整合が生じたために発生したと考えられます 🤷‍♂️

## 解決策

このような場合、Homebrewの管理ディレクトリから手動でファイルを削除することで解決できます 🛠️

1. まず、問題のパッケージがインストールされているCaskroomディレクトリを確認します 👀

```bash
> ls /opt/homebrew/Caskroom/onyx
4.8.5    4.9.2.upgrading
```

案の定、古いバージョン(`4.8.5`)と、アップグレードに失敗したと思われるディレクトリ(`4.9.2.upgrading`)が存在していました 😱

2. これらのディレクトリを直接削除します 🗑️

```bash
> rm -fr /opt/homebrew/Caskroom/onyx
```

3. 最後に、`brew outdated`を再度実行して、パッケージが表示されなくなったことを確認します ✅

```bash
> brew outdated
```

これで、問題は解決しました 🎉

## まとめ

Homebrewでパッケージのアンインストールや更新がうまくいかない場合は、Caskroomディレクトリ（`/opt/homebrew/Caskroom/`）に古いバージョンのファイルが残っていないか確認してみてください 🔍 多くの場合、問題のパッケージのディレクトリを直接削除することで、不整合を解消できます ✨
