---
title: "Mackup の挙動変更に伴うバックアップ方法の変更 📦"
description: "Mackupの挙動変更によるバックアップ方法の課題と解決策について"
pubDate: "2025-11-21"
tags: ["Mackup", "Backup", "mac"]
---

Mackupのバージョン0.8.Xから0.9.Xへのアップデートに伴い、バックアップの挙動に予期せぬ変更が発生しました 😱
具体的には、アップグレード後に`mackup backup`を実行した際にiCloud上のファイルが削除されるという問題が確認されています。

README にも注意点として記載されています 📝

[GitHub - lra/mackup](https://github.com/lra/mackup?tab=readme-ov-file)

## 従来の挙動と問題点

従来のMackupでは、`link`モード（シンボリックリンク作成）がデフォルトのバックアップ方法でした 🔗 この方法にはシンボリックリンクが正しく読み込まれない問題点があり、私の環境では以下のことを確認しました。

- トラックパッドやキーボード設定のリセット: シンボリックリンクを使用すると、環境によってはトラックパッドやキーボードの設定が初期状態に戻ってしまう事象が発生していました 😅

## 新しいバックアップ方法の実装

0.9.X から`copy`モードが実装され、デフォルトのモードが `link` モードから`copy`に変更されました 🔄

- copyモード: ファイルをそのままコピーする方法です 📋 この方法を採用する場合、定期的なバックアップ実行が必要となるため、`cron`などを用いた自動実行の設定が必須となります。

アップグレード後に `mackup backup` を実行すると`copy`モードに変更されているため、バックアップ元のファイルが削除されてしまうため注意が必要です ⚠️

## 実施した対応

0.9.X にアップグレードした後に、以下の手順で `copy`モードへ切り替えました 🛠️

1. `mackup restore -f` を実行し、全てのファイルをローカルに保存（シンボリックリンクの解除） 🔓
2. `mackup backup -f` を`cron`に設定し、定期的なバックアップを行うように変更 ⏰

この変更により、iCloud上のファイルが意図せず削除されるリスクを避け、かつ設定のリセット問題も回避できると見込んでいます ✨
